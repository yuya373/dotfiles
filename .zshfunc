function gim() {
vim `git ls-files | peco`
}

function cdgem() {
local gem_name=$(bundle list | sed -e 's/^ *\* *//g' | peco | cut -d \  -f 1)
if [ -n "$gem_name" ]; then
  local gem_dir=$(bundle show ${gem_name})
  echo "cd to ${gem_dir}"
  cd ${gem_dir}
fi
}

function pcd() {
local base="$1"
if [ ! -z "$1" ] ; then
  cd
fi
local dir="$( find . -maxdepth 1 -type d | sed -e 's;\./;;' | peco )"
if [ ! -z "$dir" ] ; then
  cd "$dir"
fi
}

function peco-select-history() {
local tac
if which tac > /dev/null; then
  tac="tac"
else
  tac="tail -r"
fi
BUFFER=$(\history -n 1 | \
  eval $tac | \
  peco --query "$LBUFFER")
CURSOR=$#BUFFER
zle clear-screen
}
zle -N peco-select-history
bindkey '^r' peco-select-history


function peco-cdr () {
local selected_dir=$(cdr -l | awk '{ print $2 }' | peco)
if [ -n "$selected_dir" ]; then
  BUFFER="cd ${selected_dir}"
  zle accept-line
fi
zle clear-screen
}
zle -N peco-cdr
bindkey '^@' peco-cdr


function peco-find-file () {
ls | peco | xargs vim -nw
zle clear-screen
}
zle -N peco-find-file
bindkey '^v' peco-find-file
