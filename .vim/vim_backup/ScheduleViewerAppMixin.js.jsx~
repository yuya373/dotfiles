/** @jsx React.DOM */

define([
  "react"
  ], function(React) {
  return {
    componentDidMount: function() {
      // console.log("test", this.props.properties);
      if( _.isEmpty(this.state.datasource) ) {
        this.updateState({"startsAt":this.props.properties.date}, {"callback":this.onUpdateState});
        return;
      }
    },
    handleSlotSelect: function(data) {
      this.setState({"selectedSlotData":data});
    },
    dismissAvCheckModal: function() {
      this.setState({"selectedSlotData":null});
    },
    proceedToPreBooking: function(data) {
      var uri = Arg.url(this.props.properties.listingAvailabilityUri, data);
      console.log("uri", uri);
      window.location = uri;
    },
    handleSlotSelect: function(data) {
      this.setState({"selectedSlotData":data});
    },
    dismissAvCheckModal: function() {
      this.setState({"selectedSlotData":null});
    },
    onUpdateState: function(params) {
      if(!params) { console.log("no params"); return; }
      this.setState({
        "datasource":params.datasource,
        "hasSlots"  :this.hasSlots(params.datasource.days)
      });
      // this.scrollToDefaultTime(this.props.properties.defaultTime);
    },
    renderBackdrop: function() {
      if(!_.isObject(this.state.selectedSlotData)) { return; }
      return <div ref="backdrop" className="modal-backdrop fade in"></div>;
    }
    // handleSlotSelect: function(data) {
    //   var uri = Arg.url(this.props.properties.listingAvailabilityUri, {
    //     date: data.date,
    //     time: DatetimeHelper.timeLabelToInt(data.startsAt)
    //   });
    //   window.location = uri;
    // },
    /*
     * Slot Select Handler
     */
    /*
     * Date Change Handler
     */
  };

});
