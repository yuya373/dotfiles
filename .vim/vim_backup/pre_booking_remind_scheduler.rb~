class PreBookingRemindScheduler
  include Sidekiq::Worker
  include Sidetiq::Schedulable

  recurrence backfill: true do
    daily.hour_of_day(10).minute_of_hour(0).second_of_minute(0)
  end

  def perform(last_occurrence, current_occurrence)
    PreBooking.where("created_at < ?", 1.days.ago).
      status_is(PreBooking.statuses[:pending]).
      find_each do |pre|
      ProviderPreBookingMailer.send_urging_mail(pre.id).deliver
    end
  end
end
