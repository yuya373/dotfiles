class BookingRequestMailer < ActionMailer::Base
  layout "mail"
  default from: APP_CONFIG["mail"]["info"]
  helper ApplicationHelper
  
  def ask(booking_request_id)
    set_booking_request(booking_request_id)
    mail subject: "[Spacee] 利用者様から空室状況のお問い合わせが届いています",
    to: @listing.email, bcc: APP_CONFIG["mail"]["mail"]
  end

  def confirmation_for_user(booking_request_id)
    set_booking_request(booking_request_id)
    mail subject: "[Spacee] 空室お問い合わせが完了しました",
      to: @
  end

  def accept(booking_request_id)
    set_booking_request(booking_request_id)
    mail subject: "[Spacee] お問い合わせ頂いた日時で空室がございます",
    to: @booking_request.user.email, bcc: APP_CONFIG["mail"]["mail"]
  end

  def deny(booking_request_id)
    set_booking_request(booking_request_id)
    mail subject: "[Spacee] お問い合わせ頂いた日時は満室となっております",
    to: @booking_request.user.email, bcc: APP_CONFIG["mail"]["mail"]
  end

  private

  def set_booking_request(booking_request_id)
    @booking_request = BookingRequest.includes(:listing,:user).
      find booking_request_id
    @listing = @booking_request.listing
  end
end
