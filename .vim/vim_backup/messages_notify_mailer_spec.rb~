require "spec_helper"

describe MessagesNotifyMailer do
  let(:user){create :user}
  let(:provider_user){create :provider_user}
  let(:pmsg){create :user_message, sender: user}
  let(:umsg){create :provider_user_message, sender: provider_user}
  let(:re){create :provider_user_receipt, receiver: provider_user}

  describe "#send_email" do
    context "to provider" do
      subject{MessagesNotifyMailer.send_email(umsg, provider_user)}
      it do
        should deliver_to(provider_user.email)
      end
      it do
        should have_body_text(provider_user.name)
      end
    end

    context "to user" do
      subject{MessagesNotifyMailer.send_email(msg, user)}

      it do
        should deliver_to(user.email)
      end
      it do
        should have_body_text(user.name)

      end

    end
  end

end
